*** Begin Patch
*** Update File: index.html
@@
-<!DOCTYPE html>
-<html lang="en">
-<head>
-  <meta charset="UTF-8">
-  <meta name="viewport" content="width=device-width, initial-scale=1.0">
-  <title>Contact Your Representatives</title>
-  <link rel="stylesheet" href="style.css">
-</head>
-<body>
-  <div class="container">
-    <header>
-      <h1>üìß Contact Your Representatives</h1>
-      <p class="tagline">Make your voice heard on the issues that matter to you</p>
-    </header>
-
-    <!-- Configuration Notice (shown when API key is missing) -->
-    <div id="config-notice" class="notice warning" style="display: none;">
-      <strong>‚ö†Ô∏è Configuration Required</strong>
-      <p>Please configure your API keys in <code>config.js</code>. See <code>README.md</code> for instructions.</p>
-    </div>
-
-    <!-- Auth Section -->
-    <div id="auth-section" class="section" style="display: none;">
-      <button id="authorize-button" class="btn btn-primary">
-        üì® Authorize Gmail to Send Messages
-      </button>
-      <p class="help-text">We'll only use this to send emails on your behalf to your representatives.</p>
-    </div>
-
-    <!-- ZIP Code Lookup -->
-    <div class="section lookup-section">
-      <label for="zipInput">Enter your ZIP code to find your representatives:</label>
-      <div class="input-group">
-        <input type="text" id="zipInput" placeholder="e.g., 03054" maxlength="5" pattern="\d{5}">
-        <button id="findBtn" class="btn btn-primary">Find My Reps</button>
-      </div>
-      <div id="loading" class="loading" style="display: none;">
-        <span class="spinner"></span> Looking up your representatives...
-      </div>
-      <div id="error" class="notice error" style="display: none;"></div>
-    </div>
-
-    <!-- Results Sections -->
-    <div id="results">
-      <!-- Federal Reps -->
-      <div id="federal-section" class="section" style="display: none;">
-        <h2>üèõÔ∏è Federal Representatives</h2>
-        <div id="federal-reps" class="reps-grid"></div>
-      </div>
-
-      <!-- State Reps -->
-      <div id="state-section" class="section" style="display: none;">
-        <h2>üè¢ State Representatives</h2>
-        <div id="state-reps" class="reps-grid"></div>
-      </div>
-
-      <!-- Local Reps -->
-      <div id="local-section" class="section" style="display: none;">
-        <h2>üèòÔ∏è Local Officials</h2>
-        <div id="local-reps" class="reps-grid"></div>
-      </div>
-
-      <!-- Favorites -->
-      <div id="favorites-section" class="section" style="display: none;">
-        <h2>‚≠ê Your Favorites</h2>
-        <div id="favorites-reps" class="reps-grid"></div>
-      </div>
-    </div>
-  </div>
-
-  <!-- Email Composer Modal -->
-  <div id="email-modal" class="modal" style="display: none;">
-    <div class="modal-content">
-      <div class="modal-header">
-        <h3>‚úâÔ∏è Compose Message</h3>
-        <button class="close-btn" onclick="closeEmailModal()">&times;</button>
-      </div>
-      <div class="modal-body">
-        <div class="recipient-info" id="recipient-info"></div>
-        
-        <label for="email-template">Quick Start (Optional):</label>
-        <select id="email-template" class="form-control">
-          <option value="">-- Write your own message --</option>
-          <option value="general">General Concern</option>
-          <option value="support">Support Legislation</option>
-          <option value="oppose">Oppose Legislation</option>
-          <option value="local-issue">Local Issue</option>
-          <option value="thank-you">Thank You</option>
-        </select>
-
-        <label for="email-subject">Subject:</label>
-        <input type="text" id="email-subject" class="form-control" placeholder="Brief description of your concern">
-
-        <label for="email-body">Your Message:</label>
-        <textarea id="email-body" class="form-control" rows="10" 
-                  placeholder="Dear [Representative Name],
-
-I am writing to you as your constituent regarding...
-
-[State your position clearly and respectfully]
-
-Thank you for your service.
-
-Sincerely,
-[Your Name]
-[Your City, State ZIP]"></textarea>
-
-        <div class="help-text">
-          <strong>Tips for effective messages:</strong>
-          <ul>
-            <li>Be clear and concise</li>
-            <li>State your position early</li>
-            <li>Include specific bill numbers if applicable</li>
-            <li>Share personal stories or local impact</li>
-            <li>Be respectful and professional</li>
-            <li>Include your contact information</li>
-          </ul>
-        </div>
-      </div>
-      <div class="modal-footer">
-        <button class="btn btn-secondary" onclick="closeEmailModal()">Cancel</button>
-        <button class="btn btn-primary" id="send-email-btn">üì§ Send Email</button>
-      </div>
-    </div>
-  </div>
-
-  <!-- Footer -->
-  <footer class="footer">
-    <p>
-      <strong>Privacy Notice:</strong> Your data stays in your browser. We don't store any information.
-      <br>
-      Powered by <a href="https://developers.google.com/civic-information" target="_blank">Google Civic Information API</a>
-    </p>
-  </footer>
-
-  <!-- Load Config First -->
-  <script src="config.js"></script>
-  <!-- Load Google API -->
-  <script src="https://apis.google.com/js/api.js" async defer onload="handleClientLoad()"></script>
-  <!-- Application Logic -->
-  <script src="script.js"></script>
-</body>
-</html>
+<!DOCTYPE html>
+<html lang="en">
+<head>
+  <meta charset="UTF-8">
+  <meta name="viewport" content="width=device-width, initial-scale=1.0">
+  <title>Contact Your Representatives</title>
+  <link rel="stylesheet" href="style.css">
+</head>
+<body>
+  <div class="container">
+    <header>
+      <h1>üìß Contact Your Representatives</h1>
+      <p class="tagline">Make your voice heard on the issues that matter to you</p>
+    </header>
+
+    <!-- Configuration Notice (shown when API key is missing) -->
+    <div id="config-notice" class="notice warning" style="display: none;">
+      <strong>‚ö†Ô∏è Configuration Required</strong>
+      <p>Please configure your API keys in <code>config.js</code>. See <code>README.md</code> for instructions.</p>
+    </div>
+
+    <!-- Auth Section -->
+    <div id="auth-section" class="section" style="display: none;">
+      <button id="authorize-button" class="btn btn-primary">
+        üì® Authorize Gmail to Send Messages
+      </button>
+      <p class="help-text">We'll only use this to send emails on your behalf to your representatives.</p>
+    </div>
+
+    <!-- ZIP Code Lookup -->
+    <div class="section lookup-section">
+      <label for="zipInput">Enter your ZIP code to find your representatives:</label>
+      <div class="input-group">
+        <input type="text" id="zipInput" placeholder="e.g., 03054" maxlength="5" pattern="\d{5}">
+        <button id="findBtn" class="btn btn-primary">Find My Reps</button>
+      </div>
+      <div id="loading" class="loading" style="display: none;">
+        <span class="spinner"></span> Looking up your representatives...
+      </div>
+      <div id="error" class="notice error" style="display: none;"></div>
+    </div>
+
+    <!-- Results Sections -->
+    <div id="results">
+      <!-- Federal Reps -->
+      <div id="federal-section" class="section" style="display: none;">
+        <h2>üèõÔ∏è Federal Representatives</h2>
+        <div id="federal-reps" class="reps-grid"></div>
+      </div>
+
+      <!-- State Reps -->
+      <div id="state-section" class="section" style="display: none;">
+        <h2>üè¢ State Representatives</h2>
+        <div id="state-reps" class="reps-grid"></div>
+      </div>
+
+      <!-- Local Reps -->
+      <div id="local-section" class="section" style="display: none;">
+        <h2>üèòÔ∏è Local Officials</h2>
+        <div id="local-reps" class="reps-grid"></div>
+      </div>
+
+      <!-- Favorites -->
+      <div id="favorites-section" class="section" style="display: none;">
+        <h2>‚≠ê Your Favorites</h2>
+        <div id="favorites-reps" class="reps-grid"></div>
+      </div>
+    </div>
+  </div>
+
+  <!-- Email Composer Modal -->
+  <div id="email-modal" class="modal" style="display: none;">
+    <div class="modal-content">
+      <div class="modal-header">
+        <h3>‚úâÔ∏è Compose Message</h3>
+        <button class="close-btn" onclick="closeEmailModal()">&times;</button>
+      </div>
+      <div class="modal-body">
+        <div class="recipient-info" id="recipient-info"></div>
+        
+        <label for="email-template">Quick Start (Optional):</label>
+        <select id="email-template" class="form-control">
+          <option value="">-- Write your own message --</option>
+          <option value="general">General Concern</option>
+          <option value="support">Support Legislation</option>
+          <option value="oppose">Oppose Legislation</option>
+          <option value="local-issue">Local Issue</option>
+          <option value="thank-you">Thank You</option>
+        </select>
+
+        <label for="email-subject">Subject:</label>
+        <input type="text" id="email-subject" class="form-control" placeholder="Brief description of your concern">
+
+        <label for="email-body">Your Message:</label>
+        <textarea id="email-body" class="form-control" rows="10" 
+                  placeholder="Dear [Representative Name],
+
+I am writing to you as your constituent regarding...
+
+[State your position clearly and respectfully]
+
+Thank you for your service.
+
+Sincerely,
+[Your Name]
+[Your City, State ZIP]"></textarea>
+
+        <div class="help-text">
+          <strong>Tips for effective messages:</strong>
+          <ul>
+            <li>Be clear and concise</li>
+            <li>State your position early</li>
+            <li>Include specific bill numbers if applicable</li>
+            <li>Share personal stories or local impact</li>
+            <li>Be respectful and professional</li>
+            <li>Include your contact information</li>
+          </ul>
+        </div>
+      </div>
+      <div class="modal-footer">
+        <button class="btn btn-secondary" onclick="closeEmailModal()">Cancel</button>
+        <button class="btn btn-primary" id="send-email-btn">üì§ Send Email</button>
+      </div>
+    </div>
+  </div>
+
+  <!-- Footer -->
+  <footer class="footer">
+    <p>
+      <strong>Privacy Notice:</strong> Your data stays in your browser. We don't store any information.
+      <br>
+      Powered by <a href="https://developers.google.com/civic-information" target="_blank">Google Civic Information API</a>
+    </p>
+  </footer>
+
+  <!-- Load Config First -->
+  <script src="config.js"></script>
+  <!-- Load application logic first so handleClientLoad exists before Google API onload runs -->
+  <script src="script.js"></script>
+  <!-- Load Google API (will call global handleClientLoad when available) -->
+  <script src="https://apis.google.com/js/api.js" async defer onload="handleClientLoad()"></script>
+</body>
+</html>
*** End Patch
*** Begin Patch
*** Update File: script.js
@@
-// script.js - Main Application Logic
-
-// Global state
-let allReps = [];
-let currentRecipient = null;
-let isGmailAuthorized = false;
-
-// === Initialization ===
-document.addEventListener('DOMContentLoaded', () => {
-  // Check configuration
-  const missingConfig = validateConfig();
-  if (missingConfig.length > 0) {
-    showConfigNotice(missingConfig);
-    return;
-  }
-  
-  // Initialize event listeners
-  document.getElementById('findBtn').addEventListener('click', findRepresentatives);
-  document.getElementById('zipInput').addEventListener('keypress', (e) => {
-    if (e.key === 'Enter') findRepresentatives();
-  });
-  
-  document.getElementById('send-email-btn').addEventListener('click', sendEmail);
-  document.getElementById('email-template').addEventListener('change', applyEmailTemplate);
-  
-  // Load favorites on startup
-  if (CONFIG.ENABLE_FAVORITES) {
-    loadFavorites();
-  }
-  
-  console.log('‚úÖ App initialized');
-});
-
-// === Google API Setup ===
-function handleClientLoad() {
-  if (!CONFIG.ENABLE_EMAIL) {
-    console.log('Email features disabled');
-    return;
-  }
-  
-  console.log('Loading Google API client...');
-  gapi.load('client:auth2', initGmailClient);
-}
-
-async function initGmailClient() {
-  try {
-    await gapi.client.init({
-      apiKey: CONFIG.GMAIL_API_KEY,
-      discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest']
-    });
-    
-    const auth = await gapi.auth2.init({
-      client_id: CONFIG.GMAIL_OAUTH_CLIENT_ID,
-      scope: 'https://www.googleapis.com/auth/gmail.send'
-    });
-    
-    auth.isSignedIn.listen(updateAuthStatus);
-    updateAuthStatus(auth.isSignedIn.get());
-    
-    document.getElementById('authorize-button').onclick = () => auth.signIn();
-    document.getElementById('auth-section').style.display = 'block';
-    
-    console.log('‚úÖ Gmail API initialized');
-  } catch (error) {
-    console.error('Gmail API initialization failed:', error);
-    showError('Gmail setup failed. Email features will be unavailable.');
-  }
-}
-
-function updateAuthStatus(isSignedIn) {
-  isGmailAuthorized = isSignedIn;
-  const authSection = document.getElementById('auth-section');
-  if (authSection) {
-    authSection.style.display = isSignedIn ? 'none' : 'block';
-  }
-  console.log('Gmail authorization status:', isSignedIn);
-}
-
-// === Configuration Notice ===
-function showConfigNotice(missing) {
-  const notice = document.getElementById('config-notice');
-  notice.innerHTML = `
-    <strong>‚ö†Ô∏è Configuration Required</strong>
-    <p>Please configure the following in <code>config.js</code>:</p>
-    <ul>
-      ${missing.map(item => `<li>${item}</li>`).join('')}
-    </ul>
-    <p>See <code>README.md</code> for detailed setup instructions.</p>
-  `;
-  notice.style.display = 'block';
-}
-
-// === Find Representatives ===
-async function findRepresentatives() {
-  const zip = document.getElementById('zipInput').value.trim();
-  
-  if (!/^\d{5}$/.test(zip)) {
-    showError('Please enter a valid 5-digit ZIP code.');
-    return;
-  }
-  
-  showLoading(true);
-  clearError();
-  hideAllSections();
-  
-  try {
-    const url = `https://www.googleapis.com/civicinfo/v2/representatives?key=${CONFIG.CIVIC_API_KEY}&address=${zip}`;
-    const response = await fetch(url);
-    
-    if (!response.ok) {
-      throw new Error(`API error: ${response.status}`);
-    }
-    
-    const data = await response.json();
-    allReps = processRepresentatives(data);
-    displayRepresentatives(allReps);
-    
-  } catch (error) {
-    console.error('Error fetching representatives:', error);
-    showError('Unable to find representatives. Please check your ZIP code and try again.');
-  } finally {
-    showLoading(false);
-  }
-}
-
-// === Process API Data ===
-function processRepresentatives(data) {
-  const reps = [];
-  
-  if (!data.offices || !data.officials) {
-    return reps;
-  }
-  
-  data.offices.forEach(office => {
-    office.officialIndices.forEach(index => {
-      const official = data.officials[index];
-      
-      reps.push({
-        name: official.name,
-        office: office.name,
-        party: official.party || 'Unknown',
-        photo: official.photoUrl || '',
-        phones: official.phones || [],
-        emails: official.emails || [],
-        urls: official.urls || [],
-        channels: official.channels || [],
-        address: official.address?.[0] || null,
-        level: determineLevel(office.name),
-        division: office.divisionId || ''
-      });
-    });
-  });
-  
-  return reps;
-}
-
-function determineLevel(officeName) {
-  const lower = officeName.toLowerCase();
-  
-  if (lower.includes('president') || lower.includes('senate') || 
-      lower.includes('representative') && lower.includes('u.s.')) {
-    return 'federal';
-  }
-  
-  if (lower.includes('governor') || lower.includes('state senate') || 
-      lower.includes('state house') || lower.includes('state representative')) {
-    return 'state';
-  }
-  
-  return 'local';
-}
-
-// === Display Representatives ===
-function displayRepresentatives(reps) {
-  const federal = reps.filter(r => r.level === 'federal');
-  const state = reps.filter(r => r.level === 'state');
-  const local = reps.filter(r => r.level === 'local');
-  
-  if (federal.length > 0) {
-    displayRepGroup('federal', federal);
-    document.getElementById('federal-section').style.display = 'block';
-  }
-  
-  if (state.length > 0) {
-    displayRepGroup('state', state);
-    document.getElementById('state-section').style.display = 'block';
-  }
-  
-  if (local.length > 0) {
-    displayRepGroup('local', local);
-    document.getElementById('local-section').style.display = 'block';
-  }
-  
-  if (CONFIG.ENABLE_FAVORITES) {
-    displayFavorites();
-  }
-}
-
-function displayRepGroup(groupId, reps) {
-  const container = document.getElementById(`${groupId}-reps`);
-  container.innerHTML = '';
-  
-  reps.forEach(rep => {
-    container.appendChild(createRepCard(rep));
-  });
-}
-
-function createRepCard(rep) {
-  const card = document.createElement('div');
-  card.className = 'rep-card';
-  
-  const isFavorite = isFavorited(rep);
-  
-  card.innerHTML = `
-    <div class="rep-header">
-      ${createPhotoElement(rep)}
-      <div class="rep-info">
-        <div class="rep-name">${rep.name}</div>
-        <span class="rep-party party-${rep.party}">${rep.party}</span>
-        <div class="rep-office">${rep.office}</div>
-      </div>
-    </div>
-    
-    ${createContactMethods(rep)}
-    
-    <div class="actions">
-      ${rep.emails && rep.emails.length > 0 ? 
-        `<button class="action-btn primary" onclick="openEmailModal('${escapeHtml(JSON.stringify(rep))}')">
-          ‚úâÔ∏è Send Email
-        </button>` : ''}
-      ${rep.phones && rep.phones.length > 0 ? 
-        `<button class="action-btn" onclick="callRep('${rep.phones[0]}')">
-          üìû Call ${rep.phones[0]}
-        </button>` : ''}
-      ${rep.urls && rep.urls.length > 0 ? 
-        `<button class="action-btn" onclick="window.open('${rep.urls[0]}', '_blank')">
-          üåê Website
-        </button>` : ''}
-    </div>
-    
-    ${CONFIG.ENABLE_FAVORITES ? 
-      `<button class="favorite-btn ${isFavorite ? 'favorited' : ''}" 
-              onclick="toggleFavorite('${escapeHtml(JSON.stringify(rep))}')"
-              title="${isFavorite ? 'Remove from favorites' : 'Add to favorites'}">
-        ${isFavorite ? '‚≠ê' : '‚òÜ'}
-      </button>` : ''}
-  `;
-  
-  return card;
-}
-
-function createPhotoElement(rep) {
-  if (rep.photo) {
-    return `<img src="${rep.photo}" alt="${rep.name}" class="rep-photo" onerror="this.outerHTML=createPlaceholder('${rep.name}')">`;
-  } else {
-    return createPlaceholder(rep.name);
-  }
-}
-
-function createPlaceholder(name) {
-  const initials = name.split(' ').map(n => n[0]).join('').substring(0, 2);
-  return `<div class="rep-photo placeholder">${initials}</div>`;
-}
-
-function createContactMethods(rep) {
-  const methods = [];
-  
-  if (rep.emails && rep.emails.length > 0) {
-    methods.push(`<div class="contact-item">üìß <a href="mailto:${rep.emails[0]}">${rep.emails[0]}</a></div>`);
-  }
-  
-  if (rep.phones && rep.phones.length > 0) {
-    methods.push(`<div class="contact-item">üìû ${rep.phones[0]}</div>`);
-  }
-  
-  if (rep.channels && rep.channels.length > 0) {
-    rep.channels.forEach(channel => {
-      const icon = getSocialIcon(channel.type);
-      methods.push(`<div class="contact-item">${icon} <a href="${getSocialUrl(channel.type, channel.id)}" target="_blank">@${channel.id}</a></div>`);
-    });
-  }
-  
-  if (methods.length === 0) return '';
-  
-  return `<div class="contact-methods">${methods.join('')}</div>`;
-}
-
-function getSocialIcon(type) {
-  const icons = {
-    'Twitter': 'üê¶',
-    'Facebook': 'üë•',
-    'YouTube': 'ÔøΩÔøΩÔøΩ',
-    'Instagram': 'üì∑'
-  };
-  return icons[type] || 'üîó';
-}
-
-function getSocialUrl(type, id) {
-  const urls = {
-    'Twitter': `https://twitter.com/${id}`,
-    'Facebook': `https://facebook.com/${id}`,
-    'YouTube': `https://youtube.com/${id}`,
-    'Instagram': `https://instagram.com/${id}`
-  };
-  return urls[type] || '#';
-}
-
-// === Email Functions ===
-function openEmailModal(repJson) {
-  currentRecipient = JSON.parse(unescapeHtml(repJson));
-  
-  if (!currentRecipient.emails || currentRecipient.emails.length === 0) {
-    alert('No email address available for this representative.');
-    return;
-  }
-  
-  if (CONFIG.ENABLE_EMAIL && !isGmailAuthorized) {
-    alert('Please authorize Gmail first to send emails.');
-    return;
-  }
-  
-  // Populate recipient info
-  document.getElementById('recipient-info').innerHTML = `
-    <strong>To:</strong> ${currentRecipient.name} (${currentRecipient.office})<br>
-    <strong>Email:</strong> ${currentRecipient.emails[0]}
-  `;
-  
-  // Reset form
-  document.getElementById('email-template').value = '';
-  document.getElementById('email-subject').value = '';
-  document.getElementById('email-body').value = '';
-  
-  // Show modal
-  document.getElementById('email-modal').style.display = 'flex';
-}
-
-function closeEmailModal() {
-  document.getElementById('email-modal').style.display = 'none';
-  currentRecipient = null;
-}
-
-function applyEmailTemplate() {
-  const templateId = document.getElementById('email-template').value;
-  if (!templateId) return;
-  
-  const template = CONFIG.EMAIL_TEMPLATES[templateId];
-  if (!template) return;
-  
-  document.getElementById('email-subject').value = template.subject;
-  document.getElementById('email-body').value = template.body.replace(/\[Representative Name\]/g, currentRecipient.name);
-}
-
-async function sendEmail() {
-  if (!currentRecipient) return;
-  
-  const subject = document.getElementById('email-subject').value.trim();
-  const body = document.getElementById('email-body').value.trim();
-  
-  if (!subject || !body) {
-    alert('Please fill in both subject and message.');
-    return;
-  }
-  
-  if (CONFIG.ENABLE_EMAIL && isGmailAuthorized) {
-    // Send via Gmail API
-    try {
-      const email = createEmailMessage(currentRecipient.emails[0], subject, body);
-      await gapi.client.gmail.users.messages.send({
-        userId: 'me',
-        resource: { raw: email }
-      });
-      
-      alert(`‚úÖ Email sent successfully to ${currentRecipient.name}!`);
-      closeEmailModal();
-    } catch (error) {
-      console.error('Error sending email:', error);
-      alert('Failed to send email. Please try again or use mailto link.');
-    }
-  } else {
-    // Fallback to mailto
-    const mailto = `mailto:${currentRecipient.emails[0]}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
-    window.location.href = mailto;
-    closeEmailModal();
-  }
-}
-
-function createEmailMessage(to, subject, body) {
-  const email = [
-    `To: ${to}`,
-    `Subject: ${subject}`,
-    '',
-    body
-  ].join('\r\n');
-  
-  return btoa(unescape(encodeURIComponent(email)))
-    .replace(/\+/g, '-')
-    .replace(/\//g, '_');
-}
-
-// === Favorites ===
-function toggleFavorite(repJson) {
-  if (!CONFIG.ENABLE_FAVORITES) return;
-  
-  const rep = JSON.parse(unescapeHtml(repJson));
-  let favorites = loadFavoritesFromStorage();
-  
-  const index = favorites.findIndex(f => f.name === rep.name && f.office === rep.office);
-  
-  if (index >= 0) {
-    favorites.splice(index, 1);
-  } else {
-    favorites.push(rep);
-  }
-  
-  saveFavoritesToStorage(favorites);
-  
-  // Refresh all displays
-  if (allReps.length > 0) {
-    displayRepresentatives(allReps);
-  } else {
-    displayFavorites();
-  }
-}
-
-function isFavorited(rep) {
-  const favorites = loadFavoritesFromStorage();
-  return favorites.some(f => f.name === rep.name && f.office === rep.office);
-}
-
-function loadFavorites() {
-  displayFavorites();
-}
-
-function displayFavorites() {
-  if (!CONFIG.ENABLE_FAVORITES) return;
-  
-  const favorites = loadFavoritesFromStorage();
-  const section = document.getElementById('favorites-section');
-  const container = document.getElementById('favorites-reps');
-  
-  if (favorites.length === 0) {
-    section.style.display = 'none';
-    return;
-  }
-  
-  container.innerHTML = '';
-  favorites.forEach(rep => {
-    container.appendChild(createRepCard(rep));
-  });
-  
-  section.style.display = 'block';
-}
-
-function loadFavoritesFromStorage() {
-  try {
-    return JSON.parse(localStorage.getItem('rep-favorites') || '[]');
-  } catch (e) {
-    return [];
-  }
-}
-
-function saveFavoritesToStorage(favorites) {
-  localStorage.setItem('rep-favorites', JSON.stringify(favorites));
-}
-
-// === Helper Functions ===
-function callRep(phone) {
-  window.location.href = `tel:${phone}`;
-}
-
-function showLoading(show) {
-  document.getElementById('loading').style.display = show ? 'block' : 'none';
-  document.getElementById('findBtn').disabled = show;
-}
-
-function showError(message) {
-  const errorDiv = document.getElementById('error');
-  errorDiv.textContent = message;
-  errorDiv.style.display = 'block';
-}
-
-function clearError() {
-  document.getElementById('error').style.display = 'none';
-}
-
-function hideAllSections() {
-  document.getElementById('federal-section').style.display = 'none';
-  document.getElementById('state-section').style.display = 'none';
-  document.getElementById('local-section').style.display = 'none';
-}
-
-function escapeHtml(text) {
-  const div = document.createElement('div');
-  div.textContent = text;
-  return div.innerHTML;
-}
-
-function unescapeHtml(html) {
-  const div = document.createElement('div');
-  div.innerHTML = html;
-  return div.textContent;
-}
-
-// Close modal when clicking outside
-window.onclick = function(event) {
-  const modal = document.getElementById('email-modal');
-  if (event.target === modal) {
-    closeEmailModal();
-  }
-};
+// script.js - Main Application Logic (refactored for safer DOM handling and fixes)
+
+// Global state
+let allReps = [];
+let currentRecipient = null;
+let isGmailAuthorized = false;
+
+// === Initialization ===
+document.addEventListener('DOMContentLoaded', () => {
+  // Check configuration
+  const missingConfig = validateConfig();
+  if (missingConfig.length > 0) {
+    showConfigNotice(missingConfig);
+    return;
+  }
+  
+  // Initialize event listeners
+  document.getElementById('findBtn').addEventListener('click', findRepresentatives);
+  document.getElementById('zipInput').addEventListener('keypress', (e) => {
+    if (e.key === 'Enter') findRepresentatives();
+  });
+  
+  document.getElementById('send-email-btn').addEventListener('click', sendEmail);
+  document.getElementById('email-template').addEventListener('change', applyEmailTemplate);
+  
+  // Load favorites on startup
+  if (CONFIG.ENABLE_FAVORITES) {
+    loadFavorites();
+  }
+  
+  console.log('‚úÖ App initialized');
+});
+
+// === Google API Setup ===
+// handleClientLoad needs to be global for the google API onload attribute
+function handleClientLoad() {
+  if (!CONFIG.ENABLE_EMAIL) {
+    console.log('Email features disabled');
+    return;
+  }
+  
+  if (typeof gapi === 'undefined') {
+    console.warn('gapi not available yet; Google API did not load. Email features will be unavailable.');
+    return;
+  }
+  
+  console.log('Loading Google API client...');
+  gapi.load('client:auth2', initGmailClient);
+}
+
+async function initGmailClient() {
+  try {
+    await gapi.client.init({
+      apiKey: CONFIG.GMAIL_API_KEY,
+      discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/gmail/v1/rest']
+    });
+    
+    const auth = await gapi.auth2.init({
+      client_id: CONFIG.GMAIL_OAUTH_CLIENT_ID,
+      scope: 'https://www.googleapis.com/auth/gmail.send'
+    });
+    
+    auth.isSignedIn.listen(updateAuthStatus);
+    updateAuthStatus(auth.isSignedIn.get());
+    
+    document.getElementById('authorize-button').onclick = () => auth.signIn();
+    document.getElementById('auth-section').style.display = 'block';
+    
+    console.log('‚úÖ Gmail API initialized');
+  } catch (error) {
+    console.error('Gmail API initialization failed:', error);
+    showError('Gmail setup failed. Email features will be unavailable.');
+  }
+}
+
+function updateAuthStatus(isSignedIn) {
+  isGmailAuthorized = isSignedIn;
+  const authSection = document.getElementById('auth-section');
+  if (authSection) {
+    authSection.style.display = isSignedIn ? 'none' : 'block';
+  }
+  console.log('Gmail authorization status:', isSignedIn);
+}
+
+// === Configuration Notice ===
+function showConfigNotice(missing) {
+  const notice = document.getElementById('config-notice');
+  notice.innerHTML = `
+    <strong>‚ö†Ô∏è Configuration Required</strong>
+    <p>Please configure the following in <code>config.js</code>:</p>
+    <ul>
+      ${missing.map(item => `<li>${item}</li>`).join('')}
+    </ul>
+    <p>See <code>README.md</code> for detailed setup instructions.</p>
+  `;
+  notice.style.display = 'block';
+}
+
+// === Find Representatives ===
+async function findRepresentatives() {
+  const zip = document.getElementById('zipInput').value.trim();
+  
+  if (!/^\d{5}$/.test(zip)) {
+    showError('Please enter a valid 5-digit ZIP code.');
+    return;
+  }
+  
+  showLoading(true);
+  clearError();
+  hideAllSections();
+  
+  try {
+    const url = `https://www.googleapis.com/civicinfo/v2/representatives?key=${CONFIG.CIVIC_API_KEY}&address=${zip}`;
+    const response = await fetch(url);
+    
+    if (!response.ok) {
+      throw new Error(`API error: ${response.status}`);
+    }
+    
+    const data = await response.json();
+    allReps = processRepresentatives(data);
+    displayRepresentatives(allReps);
+    
+  } catch (error) {
+    console.error('Error fetching representatives:', error);
+    showError('Unable to find representatives. Please check your ZIP code and try again.');
+  } finally {
+    showLoading(false);
+  }
+}
+
+// === Process API Data ===
+function processRepresentatives(data) {
+  const reps = [];
+  
+  if (!data.offices || !data.officials) {
+    return reps;
+  }
+  
+  data.offices.forEach(office => {
+    office.officialIndices.forEach(index => {
+      const official = data.officials[index];
+      
+      reps.push({
+        name: official.name,
+        office: office.name,
+        party: official.party || 'Unknown',
+        photo: official.photoUrl || '',
+        phones: official.phones || [],
+        emails: official.emails || [],
+        urls: official.urls || [],
+        channels: official.channels || [],
+        address: official.address?.[0] || null,
+        level: determineLevel(office.name, office.divisionId),
+        division: office.divisionId || ''
+      });
+    });
+  });
+  
+  return reps;
+}
+
+function determineLevel(officeName, divisionId) {
+  const lower = (officeName || '').toLowerCase();
+  const div = (divisionId || '').toLowerCase();
+  
+  // Prefer divisionId when available (it contains country/state info)
+  if (div.includes('country:us') || div.includes('ocd-division/country:us')) {
+    // Some state offices also include the state in divisionId, so check office name for state keywords
+    const federalLike = /president|senator|representative|member of congress|u.s\.|united states|congress/i;
+    if (federalLike.test(lower) || div === 'country:us') return 'federal';
+  }
+  
+  // common state keywords
+  if (lower.includes('governor') || lower.includes('state') || lower.includes('state senate') || lower.includes('state house') || lower.includes('state representative')) {
+    return 'state';
+  }
+  
+  // fallback: anything with 'county', 'city', 'mayor', 'council' is local
+  if (lower.includes('mayor') || lower.includes('council') || lower.includes('county') || lower.includes('city') || lower.includes('town') || lower.includes('board')) {
+    return 'local';
+  }
+  
+  // default to federal if we see common federal keywords
+  if (/president|senator|representative|congress/i.test(lower)) return 'federal';
+
+  return 'local';
+}
+
+// === Display Representatives ===
+function displayRepresentatives(reps) {
+  const federal = reps.filter(r => r.level === 'federal');
+  const state = reps.filter(r => r.level === 'state');
+  const local = reps.filter(r => r.level === 'local');
+  
+  if (federal.length > 0) {
+    displayRepGroup('federal', federal);
+    document.getElementById('federal-section').style.display = 'block';
+  }
+  
+  if (state.length > 0) {
+    displayRepGroup('state', state);
+    document.getElementById('state-section').style.display = 'block';
+  }
+  
+  if (local.length > 0) {
+    displayRepGroup('local', local);
+    document.getElementById('local-section').style.display = 'block';
+  }
+  
+  if (CONFIG.ENABLE_FAVORITES) {
+    displayFavorites();
+  }
+}
+
+function displayRepGroup(groupId, reps) {
+  const container = document.getElementById(`${groupId}-reps`);
+  container.innerHTML = '';
+  
+  reps.forEach(rep => {
+    container.appendChild(createRepCard(rep));
+  });
+}
+
+function createRepCard(rep) {
+  const card = document.createElement('div');
+  card.className = 'rep-card';
+  
+  // Header
+  const header = document.createElement('div');
+  header.className = 'rep-header';
+  
+  // Photo or placeholder
+  const photoContainer = document.createElement('div');
+  if (rep.photo) {
+    const img = document.createElement('img');
+    img.className = 'rep-photo';
+    img.src = rep.photo;
+    img.alt = rep.name;
+    // Safe onerror handler: replace image with placeholder element
+    img.onerror = () => {
+      const placeholder = createPlaceholderElement(rep.name);
+      img.replaceWith(placeholder);
+    };
+    photoContainer.appendChild(img);
+  } else {
+    photoContainer.appendChild(createPlaceholderElement(rep.name));
+  }
+
+  // Info
+  const info = document.createElement('div');
+  info.className = 'rep-info';
+
+  const nameEl = document.createElement('div');
+  nameEl.className = 'rep-name';
+  nameEl.textContent = rep.name;
+
+  const partyEl = document.createElement('span');
+  // normalize party into safe class name
+  const safeParty = (rep.party || 'Unknown').toString().replace(/\s+/g, '-').replace(/[^a-zA-Z0-9\-_]/g, '');
+  partyEl.className = `rep-party party-${safeParty}`;
+  partyEl.textContent = rep.party || 'Unknown';
+
+  const officeEl = document.createElement('div');
+  officeEl.className = 'rep-office';
+  officeEl.textContent = rep.office;
+
+  info.appendChild(nameEl);
+  info.appendChild(partyEl);
+  info.appendChild(officeEl);
+
+  header.appendChild(photoContainer);
+  header.appendChild(info);
+
+  card.appendChild(header);
+
+  // Contact methods
+  const contactMethods = document.createElement('div');
+  contactMethods.className = 'contact-methods';
+
+  if (rep.emails && rep.emails.length > 0) {
+    const emailItem = document.createElement('div');
+    emailItem.className = 'contact-item';
+    const mailSpan = document.createElement('span');
+    mailSpan.textContent = 'üìß ';
+    const mailLink = document.createElement('a');
+    mailLink.href = `mailto:${rep.emails[0]}`;
+    mailLink.textContent = rep.emails[0];
+    emailItem.appendChild(mailSpan);
+    emailItem.appendChild(mailLink);
+    contactMethods.appendChild(emailItem);
+  }
+
+  if (rep.phones && rep.phones.length > 0) {
+    const phoneItem = document.createElement('div');
+    phoneItem.className = 'contact-item';
+    phoneItem.textContent = `üìû ${rep.phones[0]}`;
+    contactMethods.appendChild(phoneItem);
+  }
+
+  if (rep.channels && rep.channels.length > 0) {
+    rep.channels.forEach(channel => {
+      const ch = document.createElement('div');
+      ch.className = 'contact-item';
+      const icon = document.createElement('span');
+      icon.textContent = getSocialIcon(channel.type) + ' ';
+      const a = document.createElement('a');
+      a.href = getSocialUrl(channel.type, channel.id);
+      a.target = '_blank';
+      a.rel = 'noopener noreferrer';
+      a.textContent = `@${channel.id}`;
+      ch.appendChild(icon);
+      ch.appendChild(a);
+      contactMethods.appendChild(ch);
+    });
+  }
+
+  if (contactMethods.childElementCount > 0) card.appendChild(contactMethods);
+
+  // Actions
+  const actions = document.createElement('div');
+  actions.className = 'actions';
+
+  if (rep.emails && rep.emails.length > 0) {
+    const emailBtn = document.createElement('button');
+    emailBtn.className = 'action-btn primary';
+    emailBtn.textContent = '‚úâÔ∏è Send Email';
+    emailBtn.addEventListener('click', () => openEmailModal(rep));
+    actions.appendChild(emailBtn);
+  }
+
+  if (rep.phones && rep.phones.length > 0) {
+    const callBtn = document.createElement('button');
+    callBtn.className = 'action-btn';
+    callBtn.textContent = `üìû Call ${rep.phones[0]}`;
+    callBtn.addEventListener('click', () => callRep(rep.phones[0]));
+    actions.appendChild(callBtn);
+  }
+
+  if (rep.urls && rep.urls.length > 0) {
+    const webBtn = document.createElement('button');
+    webBtn.className = 'action-btn';
+    webBtn.textContent = 'üåê Website';
+    webBtn.addEventListener('click', () => window.open(rep.urls[0], '_blank', 'noopener'));
+    actions.appendChild(webBtn);
+  }
+
+  card.appendChild(actions);
+
+  // Favorite button
+  if (CONFIG.ENABLE_FAVORITES) {
+    const fav = document.createElement('button');
+    fav.className = 'favorite-btn';
+    fav.title = isFavorited(rep) ? 'Remove from favorites' : 'Add to favorites';
+    fav.innerHTML = isFavorited(rep) ? '‚≠ê' : '‚òÜ';
+    if (isFavorited(rep)) fav.classList.add('favorited');
+    fav.addEventListener('click', (e) => {
+      e.stopPropagation();
+      toggleFavorite(rep);
+    });
+    card.appendChild(fav);
+  }
+
+  return card;
+}
+
+function createPlaceholderElement(name) {
+  const div = document.createElement('div');
+  div.className = 'rep-photo placeholder';
+  const initials = (name || '').split(' ').map(n => n[0] || '').join('').substring(0, 2).toUpperCase();
+  div.textContent = initials || '??';
+  return div;
+}
+
+function getSocialIcon(type) {
+  const icons = {
+    'Twitter': 'üê¶',
+    'Facebook': 'üë•',
+    'YouTube': 'üì∫',
+    'Instagram': 'üì∑'
+  };
+  return icons[type] || 'üîó';
+}
+
+function getSocialUrl(type, id) {
+  const urls = {
+    'Twitter': `https://twitter.com/${id}`,
+    'Facebook': `https://facebook.com/${id}`,
+    'YouTube': `https://youtube.com/${id}`,
+    'Instagram': `https://instagram.com/${id}`
+  };
+  return urls[type] || '#';
+}
+
+// === Email Functions ===
+function openEmailModal(rep) {
+  currentRecipient = rep;
+  
+  if (!currentRecipient || !currentRecipient.emails || currentRecipient.emails.length === 0) {
+    alert('No email address available for this representative.');
+    return;
+  }
+  
+  if (CONFIG.ENABLE_EMAIL && !isGmailAuthorized) {
+    alert('Please authorize Gmail first to send emails.');
+    return;
+  }
+  
+  // Populate recipient info
+  document.getElementById('recipient-info').innerHTML = `
+    <strong>To:</strong> ${escapeHtml(currentRecipient.name)} (${escapeHtml(currentRecipient.office)})<br>
+    <strong>Email:</strong> ${escapeHtml(currentRecipient.emails[0])}
+  `;
+  
+  // Reset form
+  document.getElementById('email-template').value = '';
+  document.getElementById('email-subject').value = '';
+  document.getElementById('email-body').value = '';
+  
+  // Show modal
+  document.getElementById('email-modal').style.display = 'flex';
+}
+
+function closeEmailModal() {
+  document.getElementById('email-modal').style.display = 'none';
+  currentRecipient = null;
+}
+
+function applyEmailTemplate() {
+  const templateId = document.getElementById('email-template').value;
+  if (!templateId) return;
+  
+  const template = CONFIG.EMAIL_TEMPLATES[templateId];
+  if (!template) return;
+  
+  document.getElementById('email-subject').value = template.subject;
+  const body = template.body.replace(/\[Representative Name\]/g, currentRecipient ? currentRecipient.name : '[Representative Name]');
+  document.getElementById('email-body').value = body;
+}
+
+async function sendEmail() {
+  if (!currentRecipient) return;
+  
+  const subject = document.getElementById('email-subject').value.trim();
+  const body = document.getElementById('email-body').value.trim();
+  
+  if (!subject || !body) {
+    alert('Please fill in both subject and message.');
+    return;
+  }
+  
+  if (CONFIG.ENABLE_EMAIL && isGmailAuthorized && typeof gapi !== 'undefined') {
+    // Send via Gmail API
+    try {
+      const email = createEmailMessage(currentRecipient.emails[0], subject, body);
+      await gapi.client.gmail.users.messages.send({
+        userId: 'me',
+        resource: { raw: email }
+      });
+      
+      alert(`‚úÖ Email sent successfully to ${currentRecipient.name}!`);
+      closeEmailModal();
+    } catch (error) {
+      console.error('Error sending email:', error);
+      alert('Failed to send email. Please try again or use mailto link.');
+    }
+  } else {
+    // Fallback to mailto
+    const mailto = `mailto:${currentRecipient.emails[0]}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
+    window.location.href = mailto;
+    closeEmailModal();
+  }
+}
+
+function createEmailMessage(to, subject, body) {
+  const email = [
+    `To: ${to}`,
+    `Subject: ${subject}`,
+    '',
+    body
+  ].join('\r\n');
+  
+  // base64url encode and strip padding
+  return btoa(unescape(encodeURIComponent(email)))
+    .replace(/\+/g, '-')
+    .replace(/\//g, '_')
+    .replace(/=+$/, '');
+}
+
+// === Favorites ===
+function toggleFavorite(rep) {
+  if (!CONFIG.ENABLE_FAVORITES) return;
+  
+  let favorites = loadFavoritesFromStorage();
+  
+  const index = favorites.findIndex(f => f.name === rep.name && f.office === rep.office);
+  
+  if (index >= 0) {
+    favorites.splice(index, 1);
+  } else {
+    favorites.push(rep);
+  }
+  
+  saveFavoritesToStorage(favorites);
+  
+  // Refresh all displays
+  if (allReps.length > 0) {
+    displayRepresentatives(allReps);
+  } else {
+    displayFavorites();
+  }
+}
+
+function isFavorited(rep) {
+  const favorites = loadFavoritesFromStorage();
+  return favorites.some(f => f.name === rep.name && f.office === rep.office);
+}
+
+function loadFavorites() {
+  displayFavorites();
+}
+
+function displayFavorites() {
+  if (!CONFIG.ENABLE_FAVORITES) return;
+  
+  const favorites = loadFavoritesFromStorage();
+  const section = document.getElementById('favorites-section');
+  const container = document.getElementById('favorites-reps');
+  
+  if (favorites.length === 0) {
+    section.style.display = 'none';
+    return;
+  }
+  
+  container.innerHTML = '';
+  favorites.forEach(rep => {
+    container.appendChild(createRepCard(rep));
+  });
+  
+  section.style.display = 'block';
+}
+
+function loadFavoritesFromStorage() {
+  try {
+    return JSON.parse(localStorage.getItem('rep-favorites') || '[]');
+  } catch (e) {
+    return [];
+  }
+}
+
+function saveFavoritesToStorage(favorites) {
+  localStorage.setItem('rep-favorites', JSON.stringify(favorites));
+}
+
+// === Helper Functions ===
+function callRep(phone) {
+  window.location.href = `tel:${phone}`;
+}
+
+function showLoading(show) {
+  document.getElementById('loading').style.display = show ? 'block' : 'none';
+  document.getElementById('findBtn').disabled = show;
+}
+
+function showError(message) {
+  const errorDiv = document.getElementById('error');
+  errorDiv.textContent = message;
+  errorDiv.style.display = 'block';
+}
+
+function clearError() {
+  document.getElementById('error').style.display = 'none';
+}
+
+function hideAllSections() {
+  document.getElementById('federal-section').style.display = 'none';
+  document.getElementById('state-section').style.display = 'none';
+  document.getElementById('local-section').style.display = 'none';
+}
+
+function escapeHtml(text) {
+  const div = document.createElement('div');
+  div.textContent = text;
+  return div.innerHTML;
+}
+
+function unescapeHtml(html) {
+  const div = document.createElement('div');
+  div.innerHTML = html;
+  return div.textContent;
+}
+
+// Close modal when clicking outside
+window.onclick = function(event) {
+  const modal = document.getElementById('email-modal');
+  if (event.target === modal) {
+    closeEmailModal();
+  }
+};
*** End Patch
*** Begin Patch
*** Delete File: config.js
@@
-// config.template.js
-// 
-// INSTRUCTIONS:
-// 1. Copy this file and rename it to "config.js"
-// 2. Fill in your actual API keys (see README.md for how to get them)
-// 3. Never commit config.js with real keys to version control
-// 4. Keep config.template.js as a reference
-
-const CONFIG = {
-  // ========================================
-  // REQUIRED: Google Civic Information API Key
-  // ========================================
-  // Get it from: https://console.cloud.google.com/
-  // 1. Create a project
-  // 2. Enable "Google Civic Information API"
-  // 3. Create an API key
-  CIVIC_API_KEY: 'AIzaSyCCW1QidjNLX_O0HbEd4sTxa7girN0WI1c',
-  
-  // ========================================
-  // OPTIONAL: Gmail API Configuration
-  // ========================================
-  // Only needed if you want to send emails through Gmail
-  // Get from: https://console.cloud.google.com/apis/credentials
-  GMAIL_OAUTH_CLIENT_ID: '784162659656-1u3qfphmsn3lsfbsm222pcqhtgnj0ich.apps.googleusercontent.com',
-  GMAIL_API_KEY: '69ef65dee8ace6b46f1028fba9bee84062cc5515',
-  
-  // ========================================
-  // Feature Flags
-  // ========================================
-  ENABLE_EMAIL: true,        // Set to false to disable email features entirely
-  ENABLE_FAVORITES: true,     // Set to false to disable favorites
-  
-  // ========================================
-  // Email Templates
-  // ========================================
-  // You can customize these or add your own
-  EMAIL_TEMPLATES: {
-    general: {
-      subject: 'Constituent Concern Regarding [Your Issue]',
-      body: `Dear [Representative Name],
-
-I am writing to you as your constituent from [City, State ZIP] regarding [describe your concern].
-
-[Explain your position and why this matters to you]
-
-I urge you to [your request - vote for/against, support, investigate, etc.].
-
-Thank you for your time and consideration.
-
-Sincerely,
-[Your Name]
-[Your Address]
-[Your Email]
-[Your Phone]`
-    },
-    support: {
-      subject: 'Support for [Bill Number/Issue]',
-      body: `Dear [Representative Name],
-
-I am writing to express my strong support for [Bill Number/Issue Name].
-
-[Explain why you support this legislation and how it affects you or your community]
-
-I urge you to vote in favor of this important legislation.
-
-Thank you for your service.
-
-Sincerely,
-[Your Name]
-[Your City, State ZIP]`
-    },
-    oppose: {
-      subject: 'Opposition to [Bill Number/Issue]',
-      body: `Dear [Representative Name],
-
-I am writing to express my strong opposition to [Bill Number/Issue Name].
-
-[Explain your concerns and how this legislation would negatively impact you or your community]
-
-I urge you to vote against this legislation.
-
-Thank you for considering my concerns.
-
-Sincerely,
-[Your Name]
-[Your City, State ZIP]`
-    },
-    'local-issue': {
-      subject: 'Local Concern: [Brief Description]',
-      body: `Dear [Representative Name],
-
-I am a resident of [City/Town] and I am writing to bring your attention to a local issue that affects our community: [describe the issue].
-
-[Explain the problem, its impact, and what you'd like to see done]
-
-I would appreciate your assistance in addressing this matter.
-
-Thank you for your attention to this important local issue.
-
-Sincerely,
-[Your Name]
-[Your Address]`
-    },
-    'thank-you': {
-      subject: 'Thank You for Your Support of [Issue]',
-      body: `Dear [Representative Name],
-
-I wanted to take a moment to thank you for your support of [issue/bill/action].
-
-[Explain why this matters to you and the positive impact]
-
-Your leadership on this issue is greatly appreciated.
-
-Sincerely,
-[Your Name]
-[Your City, State ZIP]`
-    }
-  }
-};
-
-// Validate configuration on load
-function validateConfig() {
-  const missing = [];
-  
-  if (!CONFIG.CIVIC_API_KEY || CONFIG.CIVIC_API_KEY === 'YOUR_GOOGLE_CIVIC_API_KEY_HERE') {
-    missing.push('Google Civic Information API Key');
-  }
-  
-  if (CONFIG.ENABLE_EMAIL) {
-    if (!CONFIG.GMAIL_OAUTH_CLIENT_ID || CONFIG.GMAIL_OAUTH_CLIENT_ID === 'YOUR_OAUTH_CLIENT_ID_HERE') {
-      missing.push('Gmail OAuth Client ID (or disable email feature)');
-    }
-    if (!CONFIG.GMAIL_API_KEY || CONFIG.GMAIL_API_KEY === 'YOUR_GMAIL_API_KEY_HERE') {
-      missing.push('Gmail API Key (or disable email feature)');
-    }
-  }
-  
-  return missing;
-}
+*** End Patch
*** Begin Patch
*** Add File: config.js
+// config.js - Placeholder configuration. DO NOT commit real keys. Copy config.template.js -> config.js and fill in real values locally.
+
+const CONFIG = {
+  // Replace the placeholders with your real keys in a local copy of this file.
+  CIVIC_API_KEY: 'YOUR_GOOGLE_CIVIC_API_KEY_HERE',
+  GMAIL_OAUTH_CLIENT_ID: 'YOUR_GMAIL_OAUTH_CLIENT_ID_HERE',
+  GMAIL_API_KEY: 'YOUR_GMAIL_API_KEY_HERE',
+
+  ENABLE_EMAIL: false,        // Set to true only after configuring OAuth and Gmail keys locally
+  ENABLE_FAVORITES: true,
+
+  EMAIL_TEMPLATES: {
+    general: {
+      subject: 'Constituent Concern Regarding [Your Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to you as your constituent from [City, State ZIP] regarding [describe your concern].\n\n[Explain your position and why this matters to you]\n\nI urge you to [your request - vote for/against, support, investigate, etc.].\n\nThank you for your time and consideration.\n\nSincerely,\n[Your Name]\n[Your Address]\n[Your Email]\n[Your Phone]`
+    },
+    support: {
+      subject: 'Support for [Bill Number/Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to express my strong support for [Bill Number/Issue Name].\n\n[Explain why you support this legislation and how it affects you or your community]\n\nI urge you to vote in favor of this important legislation.\n\nThank you for your service.\n\nSincerely,\n[Your Name]\n[Your City, State ZIP]`
+    },
+    oppose: {
+      subject: 'Opposition to [Bill Number/Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to express my strong opposition to [Bill Number/Issue Name].\n\n[Explain your concerns and how this legislation would negatively impact you or your community]\n\nI urge you to vote against this legislation.\n\nThank you for considering my concerns.\n\nSincerely,\n[Your Name]\n[Your City, State ZIP]`
+    },
+    'local-issue': {
+      subject: 'Local Concern: [Brief Description]',
+      body: `Dear [Representative Name]\n\nI am a resident of [City/Town] and I am writing to bring your attention to a local issue that affects our community: [describe the issue].\n\n[Explain the problem, its impact, and what you'd like to see done]\n\nI would appreciate your assistance in addressing this matter.\n\nThank you for your attention to this important local issue.\n\nSincerely,\n[Your Name]\n[Your Address]`
+    },
+    'thank-you': {
+      subject: 'Thank You for Your Support of [Issue]',
+      body: `Dear [Representative Name]\n\nI wanted to take a moment to thank you for your support of [issue/bill/action].\n\n[Explain why this matters to you and the positive impact]\n\nYour leadership on this issue is greatly appreciated.\n\nSincerely,\n[Your Name]\n[Your City, State ZIP]`
+    }
+  }
+};
+
+function validateConfig() {
+  const missing = [];
+  
+  if (!CONFIG.CIVIC_API_KEY || CONFIG.CIVIC_API_KEY === 'YOUR_GOOGLE_CIVIC_API_KEY_HERE') {
+    missing.push('Google Civic Information API Key');
+  }
+  
+  if (CONFIG.ENABLE_EMAIL) {
+    if (!CONFIG.GMAIL_OAUTH_CLIENT_ID || CONFIG.GMAIL_OAUTH_CLIENT_ID === 'YOUR_GMAIL_OAUTH_CLIENT_ID_HERE') {
+      missing.push('Gmail OAuth Client ID (or disable email feature)');
+    }
+    if (!CONFIG.GMAIL_API_KEY || CONFIG.GMAIL_API_KEY === 'YOUR_GMAIL_API_KEY_HERE') {
+      missing.push('Gmail API Key (or disable email feature)');
+    }
+  }
+  
+  return missing;
+}
+
*** End Patch
*** Begin Patch
*** Add File: config.template.js
+// config.template.js - Template for local configuration. Copy to config.js and fill in your real keys.
+
+const CONFIG = {
+  CIVIC_API_KEY: 'YOUR_GOOGLE_CIVIC_API_KEY_HERE',
+  GMAIL_OAUTH_CLIENT_ID: 'YOUR_GMAIL_OAUTH_CLIENT_ID_HERE',
+  GMAIL_API_KEY: 'YOUR_GMAIL_API_KEY_HERE',
+
+  ENABLE_EMAIL: false,
+  ENABLE_FAVORITES: true,
+
+  EMAIL_TEMPLATES: {
+    general: {
+      subject: 'Constituent Concern Regarding [Your Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to you as your constituent from [City, State ZIP] regarding [describe your concern].\n\n[Explain your position and why this matters to you]\n\nI urge you to [your request - vote for/against, support, investigate, etc.].\n\nThank you for your time and consideration.\n\nSincerely,\n[Your Name]\n[Your Address]\n[Your Email]\n[Your Phone]`
+    },
+    support: {
+      subject: 'Support for [Bill Number/Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to express my strong support for [Bill Number/Issue Name].\n\n[Explain why you support this legislation and how it affects you or your community]\n\nI urge you to vote in favor of this important legislation.\n\nThank you for your service.\n\nSincerely,\n[Your Name]\n[Your City, State ZIP]`
+    },
+    oppose: {
+      subject: 'Opposition to [Bill Number/Issue]',
+      body: `Dear [Representative Name]\n\nI am writing to express my strong opposition to [Bill Number/Issue Name].\n\n[Explain your concerns and how this legislation would negatively impact you or your community]\n\nI urge you to vote against this legislation.\n\nThank you for considering my concerns.\n\nSincerely,\n[Your Name]\n[Your City, State ZIP]`
+    }
+  }
+};
+
+function validateConfig() {
+  const missing = [];
+  if (!CONFIG.CIVIC_API_KEY || CONFIG.CIVIC_API_KEY === 'YOUR_GOOGLE_CIVIC_API_KEY_HERE') missing.push('Google Civic Information API Key');
+  if (CONFIG.ENABLE_EMAIL) {
+    if (!CONFIG.GMAIL_OAUTH_CLIENT_ID || CONFIG.GMAIL_OAUTH_CLIENT_ID === 'YOUR_GMAIL_OAUTH_CLIENT_ID_HERE') missing.push('Gmail OAuth Client ID');
+    if (!CONFIG.GMAIL_API_KEY || CONFIG.GMAIL_API_KEY === 'YOUR_GMAIL_API_KEY_HERE') missing.push('Gmail API Key');
+  }
+  return missing;
+}
+
*** End Patch
